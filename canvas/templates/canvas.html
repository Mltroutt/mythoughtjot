
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>mythoughtjot</title>
    <link rel="stylesheet" href="{{ MEDIA_URL }}css/style.css" type="text/css" media="screen" />
   <!-- <link rel="stylesheet" href="{{ MEDIA_URL }}css/menustyles.css" type="text/css" media="screen" /> -->
	<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
	<link rel="stylesheet" href="{{ MEDIA_URL }}css/jquery.svg.css" type="text/css" media="screen" />

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script>!window.jQuery && document.write('<script src="js/jquery-1.4.2.min.js"><\/script>')</script>
	<script src="{{ MEDIA_URL }}js/jQuery/jQuery.js"></script>

  	<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
    <script type='text/javascript' src='{{ MEDIA_URL }}js/pjs/processing-1.3.6.js'></script>
    <script type='text/javascript' src='{{ MEDIA_URL }}js/pjs/drawing.js'></script>
    <script type='text/javascript' src='{{ MEDIA_URL }}js/functions.js'></script>
    <script type='text/javascript' src='{{ MEDIA_URL }}js/jQuery/jquery.isotope.min.js'></script>
 	<script type="text/javascript" src="{{ MEDIA_URL }}js/jQuery/jqxcore.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}js/jQuery/jqxmenu.js"></script>	
  	<script src="http://tab-slide-out.googlecode.com/files/jquery.tabSlideOut.v1.3.js"></script>
	
	<script type="text/javascript" src="{{ MEDIA_URL }}js/visualize/visualize.jQuery.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/visualize/enhance.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/visualize/editabletable.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}css/visualize/basic.css"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}css/visualize/visualize.css"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}css/visualize/visualize-dark.css"></script>

	<script type="text/javascript" src="{{ MEDIA_URL }}js/svg/jquery.svg.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/svg/svg.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/raphael-min.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jQuery/jquery.topzindex.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jQuery/jquery-ink.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jQuery/jquery-fillVertically.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jQuery/common.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jQuery/jquery.event.drag-1.5.min.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/classes.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/popup.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jQuery/jquery.wysiwyg.js"></script>
		<script type="text/javascript" src="{{ MEDIA_URL }}js/graffle.js"></script>
		
		<script type="text/javascript">
		 window.onload = function() {
		 	startupMessage();
		 	changeToolbar('#firstLoad');
			$('#canvas svg').hover(function (e) {	
			  removeButton();
			  some();
		});
}
		</script>
</head>
<body>
    <noscript>mythoughtjot requires JavaScript to be enabled in your browser to work properly.</noscript>
<div id="wrapper">
  <div id="header">
	
              <div id="headerLeft">
              	
              	<div class="logo"><img src="{{ MEDIA_URL }}images/mythoughtjotLogoAASD.png" /></div>
			  </div><div class="help"></div>
        <div id="coRightHeader"> 
<h1 id="title" style="margin-top:2px; margin-bottom:2px; padding:0;">Welcome, {{ request.user.username }}</h1><span>Not {{ request.user.username}}? <a href="/logout/" style="display:inline;">Log out</a></span>
           
		</div> 
	</div>		<!-- end header-->
	
	<div id="leftCol">	
		<div id="sidebar">
            <div id='buttons'>
            	
                <ul>
                	<li onclick="changeToolbar('#drawingTools');initButtons();redo('pencil');"><div class="buttons" id="drawButton"><script type="text/javascript">renderIcon("pencil");</script></div></li>
                    <li onclick="changeToolbar('#textTools');redo('bubble');"><div class="buttons" id="textButton"><script type="text/javascript">renderIcon("bubble");</script></div></li>
                    <li onclick="changeToolbar('#shapeTools');redo('flipv');"><div class="buttons" id="shapeButton"><script type="text/javascript">renderIcon("flipv");</script></div></li>
                    <li onclick="changeToolbar('#tableTools');redo('barchart');"><div class="buttons" id="graphButton"><script type="text/javascript">renderIcon("barchart");</script></div></li>
                    <li onclick="notfinishedyet();redo('users');"><div class="buttons" id="shareButton"><script type="text/javascript">renderIcon("users");</script></div></li>
                    <li onclick="notfinishedyet();redo('search');"><div class="buttons" id="searchButton"><script type="text/javascript">renderIcon("search");</script></div></li>
					<li onclick="changeToolbar('#messagingTools');redo('mail');" id="messageButton"><div class="buttons" id="messagesButton"><script type="text/javascript">renderIcon("mail");</script></div></li>
					<li onclick="changeToolbar('#settings');redo('settings');"><div class="buttons" id="canvasButton"><script type="text/javascript">renderIcon("settings");</script></div></li>
     
                </ul>
            
        </div>
        
      <div id="popupContact">
      <a href="#" id="popupContactClose">X</a>
       <div id="messagebox">
        <p>and here they are...</p>
       </div>
       <a href="#" id="popupContactGo">Go</a>
       </div>
       <div id="backgroundPopup"></div>

	</div> <!-- End Sidebar -->

 </div> <!-- end leftCol -->
 
 
<div id="rightCol">

		<div id="updateCol">

	
	<div id="coLeftHeader">
		
        <div class="slideMenu">
		<div id="toolbox">


	<div class="toolWindow" id="drawingTools">
		<div class="inner">
			<h1>Drawing</h1>
			<input id="createBox" onclick="newDrawing();" type="button" value="START" />
				<input id="createBox" onclick="removeDrawing();" type="button" value="REMOVE" />
					<div id="modeRadio" class="left-stub">

				<input name="modeRadio" id="writingRadio" type="radio" value="writing" checked="checked" />
				<label for="writingRadio">WRITE</label>
				
				<input name="modeRadio" id="selectingRadio" type="radio" value="writing"/>
				<label for="selectingRadio">SELECT</label>				

				<input name="modeRadio" id="erasingRadio" type="radio" value="erasing" />
				<label for="erasingRadio">ERASE</label>
			</div>

			<div class="left-stub">
				<input id="clearButton" type="button" value="Clear" />
				
			</div>
		</div>
	</div>
	
	<div class="toolWindow" id="textTools">
		<div class="inner">
			<h1>Text</h1>
			<input id="createBox" onclick="createTextbox();" type="button" value="START" />
				<input id="createBox" onclick="removeTextbox();" type="button" value="REMOVE" />
				<h3>Create a Label</h3>
				<input  style="height:20px;font-size:14px; padding:2px;" type="text" id="addlabel"/>
				<input id="createtext" onclick="createLabel();" type="button" value="ADD" />
		</div>
	</div>
	
	<div class="toolWindow" id="shapeTools">
		<div class="inner">
			<h1>Shapes</h1>
		<input type="button" class="circle" onclick="drawCircle();" value="Circle"/>
		<input type="button" class="ellipse" onclick="drawEllipse();" value="Ellipse"/>
		<input type="button" class="circle" onclick="drawRect();" value="Rectangle"/>
		<input type="button" class="circle" onclick="drawRectwithRound();" value="Rounded Box"/>
		<!-- <input type="button" class="circle" onclick="drawLine();" value="Line"/>  -->
		
		</div>
	</div>
	
	<div class="toolWindow" id="tableTools">
		<div class="inner">
			<h1>Tables</h1>
		  <input type="text" style="width:36px; height:20px;font-size:14px; padding:2px;" class="valueinput" id="numRows" onclick="this.value='';" onfocus="this.select()" onblur="this.value=!this.value?'Rows':this.value;" value="Rows"/>
		  <input type="text" style="width:36px;height:20px;font-size:14px; padding:2px;"  class="valueinput" id="numColumns" onclick="this.value='';" onfocus="this.select()" onblur="this.value=!this.value?'Cols':this.value;" value="Cols"/>
          <input type="button" class="addtabletitle" onclick="createDynamicTable('table', document.getElementById('numRows').value, document.getElementById('numColumns').value)" value="New Table"/><br>
          <input type="text" style="height:20px;font-size:14px; padding:2px;"  class="valueinput" id="addtabletitle"/>
          <input type="button" class="addtabletitle" onclick="newTableTitle()" value="Add Title"/>
          <input type="button"  class="addrowButton" onclick="addtablerow() " value="Add Row"/>
          <input type="button"  class="addcolumnButton" onclick="addtablecolumn()" value="Add Column"/>
       <!-- <h3>Create Graph:</h3>
       <input type="button" class="addtabletitle" onclick="createGraph ('table', document.getElementById('tableTit').value, 'bar')" value="Bar Graph"/>  -->
	</div>
	</div>
	
	<div class="toolWindow" id="sharingTools">
		<div class="inner">
			<h1>Share</h1>
		</div>
	</div>
	
	<div class="toolWindow" id="messagingTools">
		<div class="inner">
			<h1>Messages</h1>
		</div>
	</div>

	<div class="toolWindow" id="settings">
		<div class="inner">
			<h1>Settings</h1>
			<input type="button"  class="settings" onclick="clearCanvas()" value="Clear Canvas"/>
						            {% if request.user == canvas.owner %}
            <input type="button"  id="canvas_settings_button" class="settings" value="Canvas Settings"/>
            {% endif %}
			<h3>Canvas Type:</h3>
			<input type="button"  class="background" onclick="changeCanvasBackground (6)" value="Transparent"/>
			<input type="button"  class="background" onclick="changeCanvasBackground (1)" value="Notebook"/>
			<input type="button"  class="background" onclick="changeCanvasBackground (2)" value="Graphing"/>
			<input type="button"  class="background" onclick="changeCanvasBackground (3)" value="Sketch"/>
			<input type="button"  class="background" onclick="changeCanvasBackground (4)" value="White"/>
			<input type="button"  class="background" onclick="changeCanvasBackground (5)" value="Dark"/>
		</div>
	</div>

	<div class="toolWindow" id="firstLoad">
		<div class="inner">
			<h1>Tool Options</h1>
			<h2>Click a tool to begin!</h2>
		</div>
	</div>
		</div>
		
  <section id="slidenav">

        <ul>  	
            <li class="nitem"><a href="#">Projects</a></li>
                <ul class="nsub">
                	{% for project in projects %}
                	<li><a href="/project/{{project.pk}}/">{{project.title}}</a></li>
                	{% endfor %}
                	<li><a href="/project/myprojects/">View all</a></li>
                    <li><a href="/project/create/">New Project <img src="{{ MEDIA_URL }}images/new.png"> </a></li>
                    
                </ul>
            <li class="nitem"><a href="#"><span></span> Canvases</a></li>
                <ul class="nsub">
                   {% for c in canvases %}
                   	<li><a href="/canvas/{{c.pk}}/">{{c.title}}</a></li>
                   {% endfor %}
                   <li><a href="/project/{{pid}}/">View all</a></li>
                   <li><a href="/canvas/create/" id="canvas_create">New Canvas <img src="{{ MEDIA_URL }}images/new.png"> </a></li>
                   
                </ul>
            <li class="nitem"><a href="#">Collaborators</a></li>
                <ul class="nsub"  id="updatesTab">
                
                </ul>

        </ul>
    </section>
    
<script type="text/javascript">
		$(document).ready(function() {
			
			
			$("ul#updatesTab").empty();
			//console.log(data['collaborators'])
			$("ul#updatesTab").html('&nbsp').load('/canvas/{{ canvas.pk }}/load_mini_collaborators/');

			$('.nsub').hide(); // hide sub-navigation items by default

			//checkMessages_initial();

			$('.nitem a').live('click', function(e){
				e.preventDefault();
				$(this).parent().next('.nsub').slideToggle('slow');

				if($(this).parent().next('.nsub').is(':hidden')) {
                    $(this).addClass("CurrentlySelected");
                } else {
                    $(this).removeClass("CurrentlySelected");
                }
			});
            /*
            * Canvas creation modal bax
            */
            $("#canvas_create").click(function(e){
            var url = '/canvas/create_modal/';
                        var dialog = $('<div style="display:none"></div>').appendTo('body');
                        dialog.load(
                            url,
                            function (responseText, textStatus, XMLHttpRequest) {
                                dialog.dialog({
                                 draggable: false,
                                 width: '300px',
                                 modal: true,
                                    // add a close listener to prevent adding multiple divs to the document
                                    close: function(event, ui) {
                                        // remove div with all data and events
                                        dialog.remove();
                                    }
                                });
                            }
                        );
                        //prevent the browser to follow the link
                        return false;
            });
            $(".add_collaborator").live('click', function(e){
            var url = '/canvas/{{ canvas.pk }}/add-collaborator/';
                        var dialog = $('<div id="add_collaborators" style="display:none"></div>').appendTo('body');
                        dialog.load(
                            url,
                            function (responseText, textStatus, XMLHttpRequest) {
                                dialog.dialog({
                                 draggable: false,
                                 width: '300px',
                                 modal: true,
                                    // add a close listener to prevent adding multiple divs to the document
                                    close: function(event, ui) {
                                        // remove div with all data and events
                                        dialog.remove();
                                    }
                                });
                            }
                        );
                        //prevent the browser to follow the link
                        return false;
            });
            $(".remove_collaborator").live('click', function(e){
	            e.preventDefault();
	            if(confirm("Delete this collaborator?")){
	                var link = $(this).attr("href");

	                $.get(link, function(data){
	                    if(data['success']){
	                        $("ul#updatesTab").html('&nbsp').load('/canvas/{{canvas.pk}}/load_mini_collaborators/');
	                    }else{
	                        alert(data['error']);
	                    }
	                });
	            }
            });
            $("#canvas_settings_button").click(function(e){
            var url = '/canvas/{{ canvas.pk }}/edit_modal/';
                        var dialog = $('<div style="display:none" id="canvas_settings"></div>').appendTo('body');
                        dialog.load(
                            url,
                            function (responseText, textStatus, XMLHttpRequest) {
                                dialog.dialog({
                                 draggable: false,
                                 width: 'auto',
                                 modal: true,
                                    // add a close listener to prevent adding multiple divs to the document
                                    close: function(event, ui) {
                                        // remove div with all data and events
                                        dialog.remove();
                                    }
                                });
                            }
                        );
                        //prevent the browser to follow the link
                        return false;
            });
            $("#messageButton").click(function() {
				$("#messagebox").empty();
				$("#messagebox").html('&nbsp').load('/messages/inbox_short/');
			});
			$("#save-canvas").click(function (e) {
				e.preventDefault();
				var link = $(this).attr("href"),
					data = $("#canvas").html();
					
					console.log($( '#someJunk' ).nextAll( 'svg' ));
					
					//console.log(svgs);
					
					//console.log($("#wysiwygIFrame").html());
					if($("#wysiwygIFrame").length > 0){
						data = '<div>'+data+'</div>';
						var iframeText = $("iframe#wysiwygIFrame").contents().find("body").html();
						var iframedata = "&lt;html xml:lang=\"en\" xmlns=\"http://www.w3.org/1999/xhtml\"&gt;&lt;head&gt;&lt;meta content=\"text/html; charset=UTF-8\" http-equiv=\"Content-Type\"&gt;&lt;/head&gt;&lt;body style=\"margin: 0px;\"&gt;"+iframeText+"&lt;/body&gt;&lt;/html&gt;";

					}
				$.post(link, {'canvas-data':data, csrfmiddlewaretoken: '{{ csrf_token }}'}, function(data) {
					alert(data['message']);
				});
			});
		});
		function loadCanvas() {
			
			$.get('/canvas/{{ canvas.pk }}/load_canvas/', function(data) {
				$("canvas").html(data['html']);
				if(data['iframe'].length >0){
					$("iframe#wysiwygIFrame").html('');
					$("iframe#wysiwygIFrame").html(data['iframe']);
				}
			});
		}
		/*
		function checkMessages_initial() {
			$.ajax({
	            type: "GET",
	            url: "/check_message_count/",

	            async: true,
	            cache: false,
	            timeout:50000,

	            success: function(data){
	            	if(data['count'] > 0){
	                	//alert("You have " + data['count'] + " new message.");
	               	}
	                setTimeout(
	                    'checkMessages()',
	                    5000
	                );
	            },
	            error: function(XMLHttpRequest, textStatus, errorThrown){
	                //addmsg("error", textStatus + " (" + errorThrown + ")");
	                setTimeout(
	                    'checkMessages()',
	                    30000);
	            },
	        });
		}*/
	</script>
          </div>   <!-- end slideoutMenu -->
		</div> <!-- end coLeftHeader -->
	</div>		<!-- end updateCol-->

<div id="content">
	<div id="canvas">

		<!--
<table>
	<caption id="tableTit">2009 Employee Sales by Department</caption>
	<thead>
		<tr>
			<td></td>
			<th scope="col">food</th>
			<th scope="col">auto</th>
			<th scope="col">household</th>
			<th scope="col">furniture</th>
			<th scope="col">kitchen</th>
			<th scope="col">bath</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<th scope="row">Mary</th>
			<td>190</td>
			<td>160</td>
			<td>40</td>
			<td>120</td>
			<td>30</td>
			<td>70</td>
		</tr>
		<tr>
			<th scope="row">Tom</th>
			<td>3</td>
			<td>40</td>
			<td>30</td>
			<td>45</td>
			<td>35</td>
			<td>49</td>
		</tr>	
	</tbody>
</table>
		
		-->
  </div>  <!-- end canvas -->
 </div>  <!-- end content -->
 
 	<div id="rightfooter">
	</div><!-- end rightfooter -->
  </div> <!-- end rightCol -->
 </div> <!-- end wrapper -->
</body>
</html>
